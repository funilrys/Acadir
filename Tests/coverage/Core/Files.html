<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
	<head>
		<meta http-equiv="Content-Language" content="en" />
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<title>Funombi : code coverage of Core\Files</title>
		<link rel="stylesheet" media="screen" type="text/css" href="../screen.css" title="Screen" />
	</head>
	<body>
		<div id="header">
			<h1>Code coverage of <a href="../index.html">Funombi</a>: Core\Files</h1>
			<h2>Class code coverage <span>46.43%</span></h2>
		</div>
		<div id="page">
			<div id="content">
				<h3>Methods</h3>
				<ul class="summary">
					
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 100%"></div>
										<div class="label">
											<span class="percent">100%</span>
											<a href="#getRoot">getRoot</a>
										</div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 0%"></div>
										<div class="label">
											<span class="percent">0%</span>
											<a href="#checkVitalDirectories">checkVitalDirectories</a>
										</div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 100%"></div>
										<div class="label">
											<span class="percent">100%</span>
											<a href="#matchExtensionToFileSystem">matchExtensionToFileSystem</a>
										</div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 0%"></div>
										<div class="label">
											<span class="percent">0%</span>
											<a href="#createLinkToFile">createLinkToFile</a>
										</div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 100%"></div>
										<div class="label">
											<span class="percent">100%</span>
											<a href="#isFile">isFile</a>
										</div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 100%"></div>
										<div class="label">
											<span class="percent">100%</span>
											<a href="#isDir">isDir</a>
										</div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 100%"></div>
										<div class="label">
											<span class="percent">100%</span>
											<a href="#hashFile">hashFile</a>
										</div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 0%"></div>
										<div class="label">
											<span class="percent">0%</span>
											<a href="#isHashSameAsSystem">isHashSameAsSystem</a>
										</div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 0%"></div>
										<div class="label">
											<span class="percent">0%</span>
											<a href="#getHashesContent">getHashesContent</a>
										</div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 0%"></div>
										<div class="label">
											<span class="percent">0%</span>
											<a href="#getJSON">getJSON</a>
										</div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 91.67%"></div>
										<div class="label">
											<span class="percent">91.67%</span>
											<a href="#writeDefaultDatabaseConfig">writeDefaultDatabaseConfig</a>
										</div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 92.86%"></div>
										<div class="label">
											<span class="percent">92.86%</span>
											<a href="#writeDatabaseConfig">writeDatabaseConfig</a>
										</div>
									</div>
								
							</li>
						
					
				</ul>
				<h3>Source</h3>
				<table cellpadding="0" cellspacing="0" class="source">
					<tr><th class="number">Line</th><th>Code</th></tr>
					<tr><td class="number"><a name="_flattenKeyRecursively"></a>1</td><td><pre>&lt;?php
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>2</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>3</td><td><pre>/*
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>4</td><td><pre> * The MIT License
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>5</td><td><pre> *
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>6</td><td><pre> * Copyright 2017 Nissar Chababy &lt;contact at funilrys dot com&gt;.
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>7</td><td><pre> *
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>8</td><td><pre> * Permission is hereby granted, free of charge, to any person obtaining a copy
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>9</td><td><pre> * of this software and associated documentation files (the &quot;Software&quot;), to deal
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>10</td><td><pre> * in the Software without restriction, including without limitation the rights
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>11</td><td><pre> * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>12</td><td><pre> * copies of the Software, and to permit persons to whom the Software is
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>13</td><td><pre> * furnished to do so, subject to the following conditions:
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>14</td><td><pre> *
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>15</td><td><pre> * The above copyright notice and this permission notice shall be included in
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>16</td><td><pre> * all copies or substantial portions of the Software.
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>17</td><td><pre> *
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>18</td><td><pre> * THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>19</td><td><pre> * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>20</td><td><pre> * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>21</td><td><pre> * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>22</td><td><pre> * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>23</td><td><pre> * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>24</td><td><pre> * THE SOFTWARE.
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>25</td><td><pre> */
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>26</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>27</td><td><pre>/**
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>28</td><td><pre> * Class Files | App/Core/Files.php
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>29</td><td><pre> *
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>30</td><td><pre> * @package     funombi\Core
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>31</td><td><pre> * @author      Nissar Chababy &lt;contact at funilrys dot com&gt;
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>32</td><td><pre> * @version     0.0.1
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>33</td><td><pre> * @copyright   Copyright (c) 2017, Nissar Chababy
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>34</td><td><pre> */
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>35</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>36</td><td><pre>namespace Core;
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>37</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>38</td><td><pre>use App\Config\Locations;
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>39</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>40</td><td><pre>/**
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>41</td><td><pre> * File manipulations
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>42</td><td><pre> *
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>43</td><td><pre> * @author Nissar Chababy &lt;contact at funilrys dot com&gt;
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>44</td><td><pre> */
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>45</td><td><pre>class Files
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>46</td><td><pre>{
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>47</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>48</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>49</td><td><pre>     * Give the current project root path
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>50</td><td><pre>     * 
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>51</td><td><pre>     * @return string
</pre></td></tr><tr><td class="number"><a name="_flattenKeyRecursively"></a>52</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="getRoot"></a>53</td><td><pre>    public static function getRoot()
</pre></td></tr><tr><td class="number"><a name="getRoot"></a>54</td><td><pre>    {
</pre></td></tr><tr class="covered"><td class="number">55</td><td><pre>        return dirname(__DIR__, 1) . DIRECTORY_SEPARATOR;
</pre></td></tr><tr><td class="number"><a name="getRoot"></a>56</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="getRoot"></a>57</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="getRoot"></a>58</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="getRoot"></a>59</td><td><pre>     * Return a message to inform developer that a directory is not found
</pre></td></tr><tr><td class="number"><a name="getRoot"></a>60</td><td><pre>     * 
</pre></td></tr><tr><td class="number"><a name="getRoot"></a>61</td><td><pre>     * @param string $otherDirectories Other directory to check. MUST BE UNDER Locations::PUBLIC_DIR
</pre></td></tr><tr><td class="number"><a name="getRoot"></a>62</td><td><pre>     * 
</pre></td></tr><tr><td class="number"><a name="getRoot"></a>63</td><td><pre>     * @throws \Exception Directory does not exit
</pre></td></tr><tr><td class="number"><a name="getRoot"></a>64</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="checkVitalDirectories"></a>65</td><td><pre>    public static function checkVitalDirectories($otherDirectories = null)
</pre></td></tr><tr><td class="number"><a name="checkVitalDirectories"></a>66</td><td><pre>    {
</pre></td></tr><tr><td class="number"><a name="checkVitalDirectories"></a>67</td><td><pre>        $vital = array(
</pre></td></tr><tr class="notCovered"><td class="number">68</td><td><pre>            Locations::STYLESHEETS =&gt; static::isDir(Locations::STYLESHEETS),
</pre></td></tr><tr class="notCovered"><td class="number">69</td><td><pre>            Locations::JAVASCRIPTS =&gt; static::isDir(Locations::JAVASCRIPTS),
</pre></td></tr><tr class="notCovered"><td class="number">70</td><td><pre>            Locations::IMAGES =&gt; static::isDir(Locations::IMAGES)
</pre></td></tr><tr><td class="number"><a name="checkVitalDirectories"></a>71</td><td><pre>        );
</pre></td></tr><tr><td class="number"><a name="checkVitalDirectories"></a>72</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="checkVitalDirectories"></a>73</td><td><pre>        /**
</pre></td></tr><tr><td class="number"><a name="checkVitalDirectories"></a>74</td><td><pre>         * Add ability to add/check custom directories under Locations::Public_DIR
</pre></td></tr><tr><td class="number"><a name="checkVitalDirectories"></a>75</td><td><pre>         */
</pre></td></tr><tr class="notCovered"><td class="number">76</td><td><pre>        if ($otherDirectories !== null &amp;&amp; is_array($otherDirectories)) {
</pre></td></tr><tr class="notCovered"><td class="number">77</td><td><pre>            $toCheck = array();
</pre></td></tr><tr><td class="number"><a name="checkVitalDirectories"></a>78</td><td><pre>
</pre></td></tr><tr class="notCovered"><td class="number">79</td><td><pre>            foreach ($otherDirectories as $value) {
</pre></td></tr><tr class="notCovered"><td class="number">80</td><td><pre>                $toCheck[$value] = static::isDir($value);
</pre></td></tr><tr><td class="number"><a name="checkVitalDirectories"></a>81</td><td><pre>            }
</pre></td></tr><tr><td class="number"><a name="checkVitalDirectories"></a>82</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="checkVitalDirectories"></a>83</td><td><pre>
</pre></td></tr><tr class="notCovered"><td class="number">84</td><td><pre>            $vital = array_merge($toCheck, $vital);
</pre></td></tr><tr><td class="number"><a name="checkVitalDirectories"></a>85</td><td><pre>        }
</pre></td></tr><tr><td class="number"><a name="checkVitalDirectories"></a>86</td><td><pre>
</pre></td></tr><tr class="notCovered"><td class="number">87</td><td><pre>        foreach ($vital as $key =&gt; $value) {
</pre></td></tr><tr><td class="number"><a name="checkVitalDirectories"></a>88</td><td><pre>            /**
</pre></td></tr><tr><td class="number"><a name="checkVitalDirectories"></a>89</td><td><pre>             * If it&#039;s not found, we return Exception
</pre></td></tr><tr><td class="number"><a name="checkVitalDirectories"></a>90</td><td><pre>             */
</pre></td></tr><tr class="notCovered"><td class="number">91</td><td><pre>            if ($value !== true) {
</pre></td></tr><tr class="notCovered"><td class="number">92</td><td><pre>                throw new \Exception(&quot;The (vital) directory &#039;&quot; . Locations::PUBLIC_DIR . &quot;/&quot; . $key . &quot;&#039; is not found&quot;);
</pre></td></tr><tr><td class="number"><a name="checkVitalDirectories"></a>93</td><td><pre>            }
</pre></td></tr><tr><td class="number"><a name="checkVitalDirectories"></a>94</td><td><pre>        }
</pre></td></tr><tr><td class="number"><a name="checkVitalDirectories"></a>95</td><td><pre>
</pre></td></tr><tr class="notCovered"><td class="number">96</td><td><pre>        return true;
</pre></td></tr><tr><td class="number"><a name="checkVitalDirectories"></a>97</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="checkVitalDirectories"></a>98</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="checkVitalDirectories"></a>99</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="checkVitalDirectories"></a>100</td><td><pre>     * Match a given film according to it&#039;s extension. 
</pre></td></tr><tr><td class="number"><a name="checkVitalDirectories"></a>101</td><td><pre>     * Return the directory where it should be located.
</pre></td></tr><tr><td class="number"><a name="checkVitalDirectories"></a>102</td><td><pre>     * 
</pre></td></tr><tr><td class="number"><a name="checkVitalDirectories"></a>103</td><td><pre>     * @param string $file File to match with
</pre></td></tr><tr><td class="number"><a name="checkVitalDirectories"></a>104</td><td><pre>     * 
</pre></td></tr><tr><td class="number"><a name="checkVitalDirectories"></a>105</td><td><pre>     * @return string The directory where the given file should be located
</pre></td></tr><tr><td class="number"><a name="checkVitalDirectories"></a>106</td><td><pre>     * @throws \Exception Extension is not matched
</pre></td></tr><tr><td class="number"><a name="checkVitalDirectories"></a>107</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="matchExtensionToFileSystem"></a>108</td><td><pre>    public static function matchExtensionToFileSystem($file)
</pre></td></tr><tr><td class="number"><a name="matchExtensionToFileSystem"></a>109</td><td><pre>    {
</pre></td></tr><tr><td class="number"><a name="matchExtensionToFileSystem"></a>110</td><td><pre>        $regx = array(
</pre></td></tr><tr class="covered"><td class="number">111</td><td><pre>            Locations::STYLESHEETS =&gt; &#039;/^.*\.(css)$/i&#039;,
</pre></td></tr><tr class="covered"><td class="number">112</td><td><pre>            Locations::JAVASCRIPTS =&gt; &#039;/^.*\.(js)$/i&#039;,
</pre></td></tr><tr class="covered"><td class="number">113</td><td><pre>            Locations::IMAGES =&gt; &#039;/^.*\.(jpg|jpeg|png|gif|ico)$/i&#039;
</pre></td></tr><tr><td class="number"><a name="matchExtensionToFileSystem"></a>114</td><td><pre>        );
</pre></td></tr><tr><td class="number"><a name="matchExtensionToFileSystem"></a>115</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number">116</td><td><pre>        foreach ($regx as $key =&gt; $value) {
</pre></td></tr><tr class="covered"><td class="number">117</td><td><pre>            if (preg_match($value, $file)) {
</pre></td></tr><tr class="covered"><td class="number">118</td><td><pre>                return $key;
</pre></td></tr><tr><td class="number"><a name="matchExtensionToFileSystem"></a>119</td><td><pre>            }
</pre></td></tr><tr><td class="number"><a name="matchExtensionToFileSystem"></a>120</td><td><pre>        }
</pre></td></tr><tr class="covered"><td class="number">121</td><td><pre>        throw new \Exception(&quot;The extension of $file is not accepted.&quot;);
</pre></td></tr><tr><td class="number"><a name="matchExtensionToFileSystem"></a>122</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="matchExtensionToFileSystem"></a>123</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="matchExtensionToFileSystem"></a>124</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="matchExtensionToFileSystem"></a>125</td><td><pre>     * Return a link or an HTML object linked to the desired file according 
</pre></td></tr><tr><td class="number"><a name="matchExtensionToFileSystem"></a>126</td><td><pre>     * to $type which come from matchExtensionToFileSystem()
</pre></td></tr><tr><td class="number"><a name="matchExtensionToFileSystem"></a>127</td><td><pre>     * 
</pre></td></tr><tr><td class="number"><a name="matchExtensionToFileSystem"></a>128</td><td><pre>     * @param string $file File to create Link to
</pre></td></tr><tr><td class="number"><a name="matchExtensionToFileSystem"></a>129</td><td><pre>     * @param string $type Type if the file (link =  Locations::STYLESHEETS | script = Locations::JAVASCRIPTS)
</pre></td></tr><tr><td class="number"><a name="matchExtensionToFileSystem"></a>130</td><td><pre>     * @param bool $createHTMLObject True: we create full HTML object | False: we return only the generated URL
</pre></td></tr><tr><td class="number"><a name="matchExtensionToFileSystem"></a>131</td><td><pre>     * 
</pre></td></tr><tr><td class="number"><a name="matchExtensionToFileSystem"></a>132</td><td><pre>     * @throws \Exception Impossible to create HTML object|File not found
</pre></td></tr><tr><td class="number"><a name="matchExtensionToFileSystem"></a>133</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="createLinkToFile"></a>134</td><td><pre>    public static function createLinkToFile($file, $type, $createHTMLObject = false)
</pre></td></tr><tr><td class="number"><a name="createLinkToFile"></a>135</td><td><pre>    {
</pre></td></tr><tr class="notCovered"><td class="number">136</td><td><pre>        $http = \App\Config\Sessions::SECURED_COOKIES ? &#039;https://&#039; : &#039;http://&#039;;
</pre></td></tr><tr class="notCovered"><td class="number">137</td><td><pre>        $siteURL = $http . $_SERVER[&#039;HTTP_HOST&#039;] . explode(&#039;index.php&#039;, $_SERVER[&#039;REDIRECT_URL&#039;])[0];
</pre></td></tr><tr><td class="number"><a name="createLinkToFile"></a>138</td><td><pre>
</pre></td></tr><tr class="notCovered"><td class="number">139</td><td><pre>        if (static::isFile($file) &amp;&amp; $createHTMLObject) {
</pre></td></tr><tr class="notCovered"><td class="number">140</td><td><pre>            if ($type === Locations::STYLESHEETS) {
</pre></td></tr><tr class="notCovered"><td class="number">141</td><td><pre>                echo &quot;&lt;link href = \&quot;&quot; . $siteURL . $file . &quot;\&quot; rel=\&quot;stylesheet\&quot; type=\&quot;text/css\&quot;&gt;&quot;;
</pre></td></tr><tr class="notCovered"><td class="number">142</td><td><pre>            } elseif ($type === Locations::JAVASCRIPTS) {
</pre></td></tr><tr class="notCovered"><td class="number">143</td><td><pre>                echo &quot;&lt;script src=\&quot;&quot; . $siteURL . $file . &quot;\&quot; type=\&quot;text/javascript\&quot;&gt;&lt;/script&gt;&quot;;
</pre></td></tr><tr class="notCovered"><td class="number">144</td><td><pre>            } elseif ($type === Locations::IMAGES) {
</pre></td></tr><tr class="notCovered"><td class="number">145</td><td><pre>                echo $siteURL . $file;
</pre></td></tr><tr><td class="number"><a name="createLinkToFile"></a>146</td><td><pre>            } else {
</pre></td></tr><tr class="notCovered"><td class="number">147</td><td><pre>                throw new \Exception(&quot;Impossible to create an HTLM object for &#039;&quot; . Locations::PUBLIC_DIR . &quot;/$file&#039;&quot;);
</pre></td></tr><tr><td class="number"><a name="createLinkToFile"></a>148</td><td><pre>            }
</pre></td></tr><tr class="notCovered"><td class="number">149</td><td><pre>        } elseif (!$createHTMLObject &amp;&amp; static::isFile($file)) {
</pre></td></tr><tr class="notCovered"><td class="number">150</td><td><pre>            echo $siteURL . $file;
</pre></td></tr><tr><td class="number"><a name="createLinkToFile"></a>151</td><td><pre>        } else {
</pre></td></tr><tr class="notCovered"><td class="number">152</td><td><pre>            throw new \Exception(Locations::PUBLIC_DIR . DIRECTORY_SEPARATOR . &quot;$file is not found&quot;);
</pre></td></tr><tr><td class="number"><a name="createLinkToFile"></a>153</td><td><pre>        }
</pre></td></tr><tr class="notCovered"><td class="number">154</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="createLinkToFile"></a>155</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="createLinkToFile"></a>156</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="createLinkToFile"></a>157</td><td><pre>     * Check if file exist and is readable
</pre></td></tr><tr><td class="number"><a name="createLinkToFile"></a>158</td><td><pre>     * 
</pre></td></tr><tr><td class="number"><a name="createLinkToFile"></a>159</td><td><pre>     * @param string $file File to check existence
</pre></td></tr><tr><td class="number"><a name="createLinkToFile"></a>160</td><td><pre>     *  
</pre></td></tr><tr><td class="number"><a name="createLinkToFile"></a>161</td><td><pre>     * @return bool True: Exist and is regular | False: (Don&#039;t) Exit or (not) regular
</pre></td></tr><tr><td class="number"><a name="createLinkToFile"></a>162</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="isFile"></a>163</td><td><pre>    public static function isFile($file)
</pre></td></tr><tr><td class="number"><a name="isFile"></a>164</td><td><pre>    {
</pre></td></tr><tr class="covered"><td class="number">165</td><td><pre>        if (is_file($file)) {
</pre></td></tr><tr class="covered"><td class="number">166</td><td><pre>            return true;
</pre></td></tr><tr><td class="number"><a name="isFile"></a>167</td><td><pre>        }
</pre></td></tr><tr class="covered"><td class="number">168</td><td><pre>        return false;
</pre></td></tr><tr><td class="number"><a name="isFile"></a>169</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="isFile"></a>170</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="isFile"></a>171</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="isFile"></a>172</td><td><pre>     * Check if file exist and is readable
</pre></td></tr><tr><td class="number"><a name="isFile"></a>173</td><td><pre>     * 
</pre></td></tr><tr><td class="number"><a name="isFile"></a>174</td><td><pre>     * @param string $dir Directory to check existence
</pre></td></tr><tr><td class="number"><a name="isFile"></a>175</td><td><pre>     * 
</pre></td></tr><tr><td class="number"><a name="isFile"></a>176</td><td><pre>     * @return bool True: Exist and is regular | False: (Don&#039;t) Exit or (not) regular
</pre></td></tr><tr><td class="number"><a name="isFile"></a>177</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="isDir"></a>178</td><td><pre>    public static function isDir($dir)
</pre></td></tr><tr><td class="number"><a name="isDir"></a>179</td><td><pre>    {
</pre></td></tr><tr class="covered"><td class="number">180</td><td><pre>        if (is_dir($dir)) {
</pre></td></tr><tr class="covered"><td class="number">181</td><td><pre>            return true;
</pre></td></tr><tr><td class="number"><a name="isDir"></a>182</td><td><pre>        }
</pre></td></tr><tr class="covered"><td class="number">183</td><td><pre>        return false;
</pre></td></tr><tr><td class="number"><a name="isDir"></a>184</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="isDir"></a>185</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="isDir"></a>186</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="isDir"></a>187</td><td><pre>     * Get the hash of a given file
</pre></td></tr><tr><td class="number"><a name="isDir"></a>188</td><td><pre>     * 
</pre></td></tr><tr><td class="number"><a name="isDir"></a>189</td><td><pre>     * @param string $algo Hash algorithm. Default: &#039;sha512&#039;
</pre></td></tr><tr><td class="number"><a name="isDir"></a>190</td><td><pre>     * @param string $path Path to the file
</pre></td></tr><tr><td class="number"><a name="isDir"></a>191</td><td><pre>     * 
</pre></td></tr><tr><td class="number"><a name="isDir"></a>192</td><td><pre>     * @return string
</pre></td></tr><tr><td class="number"><a name="isDir"></a>193</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="hashFile"></a>194</td><td><pre>    public static function hashFile($path, $algo = &#039;sha512&#039;)
</pre></td></tr><tr><td class="number"><a name="hashFile"></a>195</td><td><pre>    {
</pre></td></tr><tr class="covered"><td class="number">196</td><td><pre>        return hash_file($algo, $path);
</pre></td></tr><tr><td class="number"><a name="hashFile"></a>197</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="hashFile"></a>198</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="hashFile"></a>199</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="hashFile"></a>200</td><td><pre>     * Compare master file hash with local file
</pre></td></tr><tr><td class="number"><a name="hashFile"></a>201</td><td><pre>     * 
</pre></td></tr><tr><td class="number"><a name="hashFile"></a>202</td><td><pre>     * @param string $file Path to the file
</pre></td></tr><tr><td class="number"><a name="hashFile"></a>203</td><td><pre>     * @return bool True: File is the default one | False: File has been modified
</pre></td></tr><tr><td class="number"><a name="hashFile"></a>204</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="isHashSameAsSystem"></a>205</td><td><pre>    public static function isHashSameAsSystem($file)
</pre></td></tr><tr><td class="number"><a name="isHashSameAsSystem"></a>206</td><td><pre>    {
</pre></td></tr><tr class="notCovered"><td class="number">207</td><td><pre>        $currentHash = static::hashFile($file);
</pre></td></tr><tr><td class="number"><a name="isHashSameAsSystem"></a>208</td><td><pre>
</pre></td></tr><tr class="notCovered"><td class="number">209</td><td><pre>        $filepath = explode(static::getRoot(), $file);
</pre></td></tr><tr class="notCovered"><td class="number">210</td><td><pre>        $file = $filepath[1];
</pre></td></tr><tr><td class="number"><a name="isHashSameAsSystem"></a>211</td><td><pre>
</pre></td></tr><tr class="notCovered"><td class="number">212</td><td><pre>        $systemHash = static::getHashesContent(array($file =&gt; &#039;sha512&#039;))[0];
</pre></td></tr><tr><td class="number"><a name="isHashSameAsSystem"></a>213</td><td><pre>
</pre></td></tr><tr class="notCovered"><td class="number">214</td><td><pre>        if (hash_equals($currentHash, $systemHash)) {
</pre></td></tr><tr class="notCovered"><td class="number">215</td><td><pre>            return true;
</pre></td></tr><tr><td class="number"><a name="isHashSameAsSystem"></a>216</td><td><pre>        }
</pre></td></tr><tr class="notCovered"><td class="number">217</td><td><pre>        return false;
</pre></td></tr><tr><td class="number"><a name="isHashSameAsSystem"></a>218</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="isHashSameAsSystem"></a>219</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="isHashSameAsSystem"></a>220</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="isHashSameAsSystem"></a>221</td><td><pre>     * Read hashes.json and return a readable result
</pre></td></tr><tr><td class="number"><a name="isHashSameAsSystem"></a>222</td><td><pre>     * Possible algorithms: md5, sha1, sha224, sha384, sha512
</pre></td></tr><tr><td class="number"><a name="isHashSameAsSystem"></a>223</td><td><pre>     * 
</pre></td></tr><tr><td class="number"><a name="isHashSameAsSystem"></a>224</td><td><pre>     * @param array $toGet Format: array(path =&gt; algorithm)
</pre></td></tr><tr><td class="number"><a name="isHashSameAsSystem"></a>225</td><td><pre>     * @return array
</pre></td></tr><tr><td class="number"><a name="isHashSameAsSystem"></a>226</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="getHashesContent"></a>227</td><td><pre>    public static function getHashesContent($toGet)
</pre></td></tr><tr><td class="number"><a name="getHashesContent"></a>228</td><td><pre>    {
</pre></td></tr><tr class="notCovered"><td class="number">229</td><td><pre>        $json = static::getJSON(static::getRoot() . &#039;hashes.json&#039;);
</pre></td></tr><tr class="notCovered"><td class="number">230</td><td><pre>        $hashes = Arrays::flattenKeysRecursively($json);
</pre></td></tr><tr class="notCovered"><td class="number">231</td><td><pre>        $result = array();
</pre></td></tr><tr><td class="number"><a name="getHashesContent"></a>232</td><td><pre>
</pre></td></tr><tr class="notCovered"><td class="number">233</td><td><pre>        foreach ($toGet as $key =&gt; $value) {
</pre></td></tr><tr class="notCovered"><td class="number">234</td><td><pre>            $key = str_replace(&#039;/&#039;, &#039;.&#039;, $key) . &#039;.&#039; . $value;
</pre></td></tr><tr class="notCovered"><td class="number">235</td><td><pre>            $result = array_merge($result, array($hashes[$key]));
</pre></td></tr><tr><td class="number"><a name="getHashesContent"></a>236</td><td><pre>        }
</pre></td></tr><tr><td class="number"><a name="getHashesContent"></a>237</td><td><pre>
</pre></td></tr><tr class="notCovered"><td class="number">238</td><td><pre>        return $result;
</pre></td></tr><tr><td class="number"><a name="getHashesContent"></a>239</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="getHashesContent"></a>240</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="getHashesContent"></a>241</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="getHashesContent"></a>242</td><td><pre>     * Get and read the content of a JSON
</pre></td></tr><tr><td class="number"><a name="getHashesContent"></a>243</td><td><pre>     * 
</pre></td></tr><tr><td class="number"><a name="getHashesContent"></a>244</td><td><pre>     * @param string $file The file to get
</pre></td></tr><tr><td class="number"><a name="getHashesContent"></a>245</td><td><pre>     * @return data|false
</pre></td></tr><tr><td class="number"><a name="getHashesContent"></a>246</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="getJSON"></a>247</td><td><pre>    public static function getJSON($file)
</pre></td></tr><tr><td class="number"><a name="getJSON"></a>248</td><td><pre>    {
</pre></td></tr><tr class="notCovered"><td class="number">249</td><td><pre>        $str = file_get_contents($file);
</pre></td></tr><tr class="notCovered"><td class="number">250</td><td><pre>        $decoded = json_decode($str, true);
</pre></td></tr><tr><td class="number"><a name="getJSON"></a>251</td><td><pre>
</pre></td></tr><tr class="notCovered"><td class="number">252</td><td><pre>        return $decoded;
</pre></td></tr><tr><td class="number"><a name="getJSON"></a>253</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="getJSON"></a>254</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="getJSON"></a>255</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="getJSON"></a>256</td><td><pre>     * Write the default data into App\Config\Database
</pre></td></tr><tr><td class="number"><a name="getJSON"></a>257</td><td><pre>     * 
</pre></td></tr><tr><td class="number"><a name="getJSON"></a>258</td><td><pre>     * @return boolean
</pre></td></tr><tr><td class="number"><a name="getJSON"></a>259</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="writeDefaultDatabaseConfig"></a>260</td><td><pre>    public static function writeDefaultDatabaseConfig()
</pre></td></tr><tr><td class="number"><a name="writeDefaultDatabaseConfig"></a>261</td><td><pre>    {
</pre></td></tr><tr><td class="number"><a name="writeDefaultDatabaseConfig"></a>262</td><td><pre>        $consts = array(
</pre></td></tr><tr class="covered"><td class="number">263</td><td><pre>            &#039;DB_HOST&#039; =&gt; &#039;your-database-host&#039;,
</pre></td></tr><tr><td class="number"><a name="writeDefaultDatabaseConfig"></a>264</td><td><pre>            &#039;DB_NAME&#039; =&gt; &#039;your-database-name&#039;,
</pre></td></tr><tr><td class="number"><a name="writeDefaultDatabaseConfig"></a>265</td><td><pre>            &#039;DB_USER&#039; =&gt; &#039;your-database-username&#039;,
</pre></td></tr><tr><td class="number"><a name="writeDefaultDatabaseConfig"></a>266</td><td><pre>            &#039;DB_PASSWORD&#039; =&gt; &#039;your-database-password&#039;,
</pre></td></tr><tr><td class="number"><a name="writeDefaultDatabaseConfig"></a>267</td><td><pre>            &#039;TABLE_PREFIX&#039; =&gt; &#039;your-table-prefix&#039;
</pre></td></tr><tr><td class="number"><a name="writeDefaultDatabaseConfig"></a>268</td><td><pre>        );
</pre></td></tr><tr><td class="number"><a name="writeDefaultDatabaseConfig"></a>269</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number">270</td><td><pre>        $root = static::getRoot();
</pre></td></tr><tr class="covered"><td class="number">271</td><td><pre>        $databaseFile = $root . &#039;App&#039; . DIRECTORY_SEPARATOR . &#039;Config&#039; . DIRECTORY_SEPARATOR . &#039;Database.php&#039;;
</pre></td></tr><tr><td class="number"><a name="writeDefaultDatabaseConfig"></a>272</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number">273</td><td><pre>        foreach ($consts as $key =&gt; $value) {
</pre></td></tr><tr class="covered"><td class="number">274</td><td><pre>            $currentFile = file_get_contents($databaseFile);
</pre></td></tr><tr><td class="number"><a name="writeDefaultDatabaseConfig"></a>275</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number">276</td><td><pre>            $regex = &quot;/const $key = .*;/&quot;;
</pre></td></tr><tr class="covered"><td class="number">277</td><td><pre>            $replacement = &quot;const $key = &#039;$value&#039;;&quot;;
</pre></td></tr><tr><td class="number"><a name="writeDefaultDatabaseConfig"></a>278</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number">279</td><td><pre>            $currentFile = preg_replace($regex, $replacement, $currentFile);
</pre></td></tr><tr><td class="number"><a name="writeDefaultDatabaseConfig"></a>280</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number">281</td><td><pre>            if (file_put_contents($databaseFile, $currentFile)) {
</pre></td></tr><tr class="covered"><td class="number">282</td><td><pre>                continue;
</pre></td></tr><tr><td class="number"><a name="writeDefaultDatabaseConfig"></a>283</td><td><pre>            }
</pre></td></tr><tr class="notCovered"><td class="number">284</td><td><pre>            return false;
</pre></td></tr><tr><td class="number"><a name="writeDefaultDatabaseConfig"></a>285</td><td><pre>        }
</pre></td></tr><tr class="covered"><td class="number">286</td><td><pre>        return true;
</pre></td></tr><tr><td class="number"><a name="writeDefaultDatabaseConfig"></a>287</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="writeDefaultDatabaseConfig"></a>288</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="writeDefaultDatabaseConfig"></a>289</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="writeDefaultDatabaseConfig"></a>290</td><td><pre>     * Function that make it easy to change the defaults credentials of
</pre></td></tr><tr><td class="number"><a name="writeDefaultDatabaseConfig"></a>291</td><td><pre>     * App/Config/Database.php
</pre></td></tr><tr><td class="number"><a name="writeDefaultDatabaseConfig"></a>292</td><td><pre>     * 
</pre></td></tr><tr><td class="number"><a name="writeDefaultDatabaseConfig"></a>293</td><td><pre>     * @param array $data Database credentials | keys, host, name, user, password, prefix
</pre></td></tr><tr><td class="number"><a name="writeDefaultDatabaseConfig"></a>294</td><td><pre>     * @return bool
</pre></td></tr><tr><td class="number"><a name="writeDefaultDatabaseConfig"></a>295</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="writeDatabaseConfig"></a>296</td><td><pre>    public static function writeDatabaseConfig($data)
</pre></td></tr><tr><td class="number"><a name="writeDatabaseConfig"></a>297</td><td><pre>    {
</pre></td></tr><tr class="covered"><td class="number">298</td><td><pre>        if (is_array($data)) {
</pre></td></tr><tr class="covered"><td class="number">299</td><td><pre>            $root = static::getRoot();
</pre></td></tr><tr class="covered"><td class="number">300</td><td><pre>            $databaseFile = $root . &#039;App&#039; . DIRECTORY_SEPARATOR . &#039;Config&#039; . DIRECTORY_SEPARATOR . &#039;Database.php&#039;;
</pre></td></tr><tr><td class="number"><a name="writeDatabaseConfig"></a>301</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number">302</td><td><pre>            $currentFile = file_get_contents($databaseFile);
</pre></td></tr><tr><td class="number"><a name="writeDatabaseConfig"></a>303</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number">304</td><td><pre>            if (strpos($currentFile, &#039;your&#039;) !== false) {
</pre></td></tr><tr><td class="number"><a name="writeDatabaseConfig"></a>305</td><td><pre>                $oldToNew = array(
</pre></td></tr><tr class="covered"><td class="number">306</td><td><pre>                    &#039;host&#039; =&gt; &#039;your-database-host&#039;,
</pre></td></tr><tr><td class="number"><a name="writeDatabaseConfig"></a>307</td><td><pre>                    &#039;name&#039; =&gt; &#039;your-database-name&#039;,
</pre></td></tr><tr><td class="number"><a name="writeDatabaseConfig"></a>308</td><td><pre>                    &#039;user&#039; =&gt; &#039;your-database-username&#039;,
</pre></td></tr><tr><td class="number"><a name="writeDatabaseConfig"></a>309</td><td><pre>                    &#039;password&#039; =&gt; &#039;your-database-password&#039;,
</pre></td></tr><tr><td class="number"><a name="writeDatabaseConfig"></a>310</td><td><pre>                    &#039;prefix&#039; =&gt; &#039;your-table-prefix&#039;
</pre></td></tr><tr><td class="number"><a name="writeDatabaseConfig"></a>311</td><td><pre>                );
</pre></td></tr><tr><td class="number"><a name="writeDatabaseConfig"></a>312</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number">313</td><td><pre>                foreach ($oldToNew as $key =&gt; $value) {
</pre></td></tr><tr class="covered"><td class="number">314</td><td><pre>                    if (isset($data[$key])) {
</pre></td></tr><tr class="covered"><td class="number">315</td><td><pre>                        $currentFile = str_replace($value, $data[$key], $currentFile);
</pre></td></tr><tr><td class="number"><a name="writeDatabaseConfig"></a>316</td><td><pre>                    }
</pre></td></tr><tr><td class="number"><a name="writeDatabaseConfig"></a>317</td><td><pre>                }
</pre></td></tr><tr><td class="number"><a name="writeDatabaseConfig"></a>318</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number">319</td><td><pre>                if (file_put_contents($databaseFile, $currentFile)) {
</pre></td></tr><tr class="covered"><td class="number">320</td><td><pre>                    return true;
</pre></td></tr><tr><td class="number"><a name="writeDatabaseConfig"></a>321</td><td><pre>                }
</pre></td></tr><tr class="notCovered"><td class="number">322</td><td><pre>                return false;
</pre></td></tr><tr><td class="number"><a name="writeDatabaseConfig"></a>323</td><td><pre>            }
</pre></td></tr><tr class="covered"><td class="number">324</td><td><pre>            return false;
</pre></td></tr><tr><td class="number"><a name="writeDatabaseConfig"></a>325</td><td><pre>        }
</pre></td></tr><tr class="covered"><td class="number">326</td><td><pre>        return false;
</pre></td></tr><tr><td class="number"><a name="writeDatabaseConfig"></a>327</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="writeDatabaseConfig"></a>328</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="writeDatabaseConfig"></a>329</td><td><pre>}
</pre></td></tr>
				</table>
			</div>
		</div>
		<div id="footer">
			<p>Code coverage report powered by <a href="http://atoum.org">atoum</a></p>
		</div>
	</body>
</html>
